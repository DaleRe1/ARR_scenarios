<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ARR Scenarios</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --grad-1: linear-gradient(135deg,#141e30 0%,#243b55 100%);
  --grad-2: linear-gradient(135deg,#1d4350 0%,#a43931 100%);
  --font: 'Inter', sans-serif;
  --accent: #ffd166;
  --card: rgba(255,255,255,.12);
  --card-hover: rgba(255,255,255,.18);
}
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;font-family:var(--font);color:#f2f4f8;scroll-behavior:smooth;overflow-x:hidden}
body{scroll-snap-type:y mandatory}

.slide{
  width:100vw;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  scroll-snap-align:start;
  padding:2rem 1rem;
  text-align:center;
  position:relative;
}

#slide-1{background:var(--grad-1)}
#slide-2{background:var(--grad-2)}

h1{
  font-size:2.2rem;
  font-weight:700;
  margin-bottom:1rem;
  line-height:1.2;
}

h2{
  font-size:1.8rem;
  font-weight:700;
  margin-bottom:1rem;
  line-height:1.3;
}

h3{
  font-size:1.3rem;
  font-weight:600;
  margin-bottom:0.8rem;
}

p{
  font-size:1.1rem;
  line-height:1.5;
  opacity:0.9;
  margin-bottom:1.5rem;
}

button{
  cursor:pointer;
  background:var(--accent);
  border:none;
  border-radius:12px;
  padding:1rem 2rem;
  margin-top:2rem;
  font-weight:600;
  color:#141e30;
  font-size:1.1rem;
  min-height:48px;
  transition:transform 0.2s ease;
}

button:active{
  transform:scale(0.95);
}

/* Mobile-optimized table */
.table-container{
  width:100%;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  margin:1rem 0;
  border-radius:12px;
  background:var(--card);
  backdrop-filter:blur(8px);
}

table{
  border-collapse:collapse;
  font-size:0.9rem;
  width:100%;
  min-width:700px;
}

th,td{
  padding:1rem 0.8rem;
  text-align:center;
  border-bottom:1px solid rgba(255,255,255,0.1);
}

th{
  opacity:0.9;
  font-weight:600;
  background:rgba(255,255,255,0.05);
  font-size:0.85rem;
  line-height:1.3;
}

tr:nth-child(even){
  background:rgba(255,255,255,.04);
}

.pos{color:#06d6a0;font-weight:600}
.neg{color:#ff6b6b;font-weight:600}
.na{color:#9ca3af;font-style:italic}

.note{
  position:absolute;
  bottom:1rem;
  left:1rem;
  right:1rem;
  background:var(--card);
  padding:1.2rem;
  border-radius:12px;
  font-size:0.9rem;
  backdrop-filter:blur(6px);
  text-align:left;
}

.note strong{
  display:block;
  margin-bottom:0.5rem;
  font-size:1rem;
}

.note ul{
  margin-left:1.2rem;
}

.note li{
  list-style:square;
  margin:0.4rem 0;
  line-height:1.4;
}

/* Slide 2 - Mobile Controls */
.controls-container{
  width:100%;
  max-width:500px;
  margin:1rem auto;
}

.control{
  background:var(--card);
  padding:1.5rem;
  border-radius:16px;
  backdrop-filter:blur(8px);
  margin-bottom:1.5rem;
  transition:background 0.3s ease;
}

.control:active{
  background:var(--card-hover);
}

.control h3{
  color:var(--accent);
  text-align:center;
  margin-bottom:1.2rem;
}

.slider-group{
  margin-bottom:1.2rem;
}

label{
  display:block;
  font-size:1rem;
  margin-bottom:0.5rem;
  font-weight:500;
}

.value{
  display:block;
  font-weight:700;
  font-size:1.2rem;
  color:var(--accent);
  text-align:center;
  margin:0.8rem 0;
}

input[type=range]{
  width:100%;
  height:8px;
  border-radius:4px;
  background:rgba(255,255,255,0.2);
  outline:none;
  -webkit-appearance:none;
  margin:0.5rem 0;
}

input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none;
  appearance:none;
  width:24px;
  height:24px;
  border-radius:50%;
  background:var(--accent);
  cursor:pointer;
  box-shadow:0 2px 8px rgba(0,0,0,0.3);
}

input[type=range]::-moz-range-thumb{
  width:24px;
  height:24px;
  border-radius:50%;
  background:var(--accent);
  cursor:pointer;
  border:none;
  box-shadow:0 2px 8px rgba(0,0,0,0.3);
}

#metrics{
  background:var(--card);
  padding:1.5rem;
  border-radius:16px;
  backdrop-filter:blur(8px);
  margin:1.5rem auto;
  max-width:500px;
  font-size:1rem;
}

#metrics h3{
  text-align:center;
  margin-bottom:1rem;
  color:var(--accent);
}

#metrics p{
  text-align:left;
  margin-bottom:0.8rem;
  font-size:0.95rem;
  line-height:1.5;
}

#metrics hr{
  border:none;
  border-top:2px solid rgba(255,255,255,.25);
  margin:1.2rem 0;
}

/* iPad specific optimizations */
@media (min-width: 768px) {
  .slide{
    padding:3rem 2rem;
  }
  
  h1{font-size:2.8rem}
  h2{font-size:2.2rem}
  
  .controls-container{
    max-width:600px;
  }
  
  .control{
    padding:2rem;
  }
  
  #metrics{
    max-width:700px;
    padding:2rem;
  }
  
  table{
    font-size:1rem;
  }
  
  th,td{
    padding:1.2rem 1rem;
  }
}

/* Large tablets and desktop */
@media (min-width: 1024px) {
  .controls-container{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:1.5rem;
    max-width:1000px;
  }
  
  #metrics{
    max-width:800px;
  }
}

/* Fix for very small phones */
@media (max-width: 375px) {
  h1{font-size:1.8rem}
  h2{font-size:1.5rem}
  
  .slide{
    padding:1.5rem 0.8rem;
  }
  
  .note{
    font-size:0.8rem;
    padding:1rem;
  }
}
</style>
</head>
<body>
<!-- ============ CONFIG ============ -->
<script>
const PERIOD = { cur:'Jul-25', prev:'Jun-25', ytd:'Dec-24' };
const SUMMARY=[
  {name:'E‑Commerce / SMB',cl:{cur:6112,prev:6008,ytd:5615},ar:{cur:10.5,prev:10.3,ytd:9.49}},
  {name:'Stripe BR',       cl:{cur:37,  prev:33,  ytd:null}, ar:{cur:0.1, prev:0.1,ytd:null}},
  {name:'Enterprise',      cl:{cur:66,  prev:64,  ytd:64},   ar:{cur:3.7, prev:3.6,ytd:3.60}}
];
const SENS=[
  {key:'e',name:'E‑Commerce SMB',baseClients:6112,baseARPU:143, addMax:5000, arpuMin:130, arpuMax:260, churnDefault:0},
  {key:'n',name:'Enterprise',    baseClients:66,  baseARPU:4650,addMax:150,  arpuMin:2000,arpuMax:9000,churnDefault:0},
  {key:'b',name:'Stripe BR',     baseClients:37,  baseARPU:180, addMax:15000,arpuMin:100, arpuMax:500, churnDefault:0}
];
</script>
<!-- ============ SLIDE 1 ============ -->
<section class="slide" id="slide-1">
  <h1>ARR Focus</h1>
  <p>Segment Allocation – Client & ARR Growth (MoM & YTD)</p>
  <div class="table-container">
    <table id="tbl"></table>
  </div>
  <div class="note">
    <strong>Scope – Billed ARR only</strong>
    <ul>
      <li>Stripe BR clients registered but not yet invoiced are excluded</li>
      <li>Enterprise contracts signed but not yet activated are excluded</li>
    </ul>
  </div>
  <button onclick="document.getElementById('slide-2').scrollIntoView()">Next → Sensitivity</button>
</section>
<!-- ============ SLIDE 2 ============ -->
<section class="slide" id="slide-2">
  <h2>MRR / ARR Sensitivity</h2>
  <p>Adjust Net Client Adds, Churn %, and ARPU.<br>Metrics update live.</p>
  <div class="controls-container" id="ctrlGrid"></div>
  <div id="metrics"><h3>Sensitivity Output</h3><div id="outBody"></div></div>
</section>
<!-- ============ SCRIPT ============ -->
<script>
/***** helpers *****/
const $=id=>document.getElementById(id);
const fmt=n=>n.toLocaleString('en-GB');
const euro=v=>'€'+fmt(v);
/***** Slide 1 builder *****/
function pct(a,b){return (b?((a-b)/b*100):null);}
function pctCell(a,b){const p=pct(a,b);if(p==null)return '<span class="na">—</span>';const cls=p>=0?'pos':'neg';const s=p>=0?'+':'';return `<span class="${cls}">${s}${p.toFixed(0)}%</span>`;}
function cell(v,dec=0){return v==null?'<span class="na">—</span>':dec?v.toFixed(dec):fmt(v);} 
function buildTable(){
 const rows=SUMMARY.map(s=>`<tr><td>${s.name}</td>
 <td>${cell(s.cl.cur)}</td><td>${cell(s.cl.prev)}</td><td>${pctCell(s.cl.cur,s.cl.prev)}</td><td>${pctCell(s.cl.cur,s.cl.ytd)}</td>
 <td>${cell(s.ar.cur,1)}</td><td>${cell(s.ar.prev,1)}</td><td>${pctCell(s.ar.cur,s.ar.prev)}</td><td>${pctCell(s.ar.cur,s.ar.ytd)}</td></tr>`).join('');
 const totals=SUMMARY.reduce((t,s)=>{
  if(s.cl.cur!=null)t.clCur+=s.cl.cur;
  if(s.cl.prev!=null)t.clPrev+=s.cl.prev;
  if(s.cl.ytd!=null)t.clYTD+=s.cl.ytd;
  if(s.ar.cur!=null)t.arCur+=s.ar.cur;
  if(s.ar.prev!=null)t.arPrev+=s.ar.prev;
  if(s.ar.ytd!=null)t.arYTD+=s.ar.ytd;return t;},{clCur:0,clPrev:0,clYTD:0,arCur:0,arPrev:0,arYTD:0});
 const totalRow=`<tr style="font-weight:600;border-top:2px solid rgba(255,255,255,.3);background:rgba(255,255,255,.08)"><td>Total</td>
 <td>${fmt(totals.clCur)}</td><td>${fmt(totals.clPrev)}</td><td>${pctCell(totals.clCur,totals.clPrev)}</td><td>${pctCell(totals.clCur,totals.clYTD)}</td>
 <td>${totals.arCur.toFixed(1)}</td><td>${totals.arPrev.toFixed(1)}</td><td>${pctCell(totals.arCur,totals.arPrev)}</td><td>${pctCell(totals.arCur,totals.arYTD)}</td></tr>`;
 const head=`<thead><tr><th rowspan="2">Segment</th><th colspan="4">Clients</th><th colspan="4">ARR (€ m)</th></tr>
 <tr><th>${PERIOD.cur}</th><th>${PERIOD.prev}</th><th>MoM %</th><th>YTD<br>vs ${PERIOD.ytd}</th>
     <th>${PERIOD.cur}</th><th>${PERIOD.prev}</th><th>MoM %</th><th>YTD<br>vs ${PERIOD.ytd}</th></tr></thead>`;
 $('tbl').innerHTML=head+'<tbody>'+rows+totalRow+'</tbody>';
}
/***** Slide 2 builder *****/
function buildControls(){
 const g=$('ctrlGrid');
 g.innerHTML=SENS.map(seg=>`<div class="control" id="c-${seg.key}">
  <h3>${seg.name}</h3>
  <div class="slider-group">
    <label>Net Client Adds (0 – ${fmt(seg.addMax)})</label>
    <input type="range" id="${seg.key}Adds" min="0" max="${seg.addMax}" step="${seg.addMax>500?100:1}" value="0">
    <span class="value" id="${seg.key}AddsVal">0</span>
  </div>
  <div class="slider-group">
    <label>Churn % (0 – 10)</label>
    <input type="range" id="${seg.key}Churn" min="0" max="10" step="0.1" value="${seg.churnDefault}">
    <span class="value" id="${seg.key}ChurnVal">${seg.churnDefault.toFixed(1)}%</span>
  </div>
  <div class="slider-group">
    <label>ARPU (€${fmt(seg.arpuMin)} – €${fmt(seg.arpuMax)})</label>
    <input type="range" id="${seg.key}Arpu" min="${seg.arpuMin}" max="${seg.arpuMax}" step="${seg.arpuMin<200?1:100}" value="${seg.baseARPU}">
    <span class="value" id="${seg.key}ArpuVal">€${fmt(seg.baseARPU)}</span>
  </div>
 </div>`).join('');
}
function calc(){
 let totMRR=0,totARR=0,html='';
 SENS.forEach(seg=>{
  const adds=+$(seg.key+'Adds').value;
  const churn=+$(seg.key+'Churn').value/100;
  const arpu=+$(seg.key+'Arpu').value;
  const clients=Math.round((seg.baseClients+adds)*(1-churn));
  const mrr=clients*arpu;
  const arr=mrr*12;
  totMRR+=mrr;totARR+=arr;
  // update value readouts
  $(seg.key+'AddsVal').textContent=fmt(adds);
  $(seg.key+'ChurnVal').textContent=(churn*100).toFixed(1)+'%';
  $(seg.key+'ArpuVal').textContent=euro(arpu);
  html+=`<p><strong>${seg.name}</strong><br>Clients: ${fmt(clients)} | MRR: ${euro(mrr)}<br>ARR: ${euro(arr)}</p>`;
 });
 html+='<hr><p><strong>Total MRR:</strong> '+euro(totMRR)+'<br><strong>Total ARR:</strong> '+euro(totARR)+'</p>';
 $('outBody').innerHTML=html;
}
/***** init *****/
window.addEventListener('DOMContentLoaded',()=>{
 buildTable();
 buildControls();
 // bind events
 SENS.forEach(seg=>['Adds','Churn','Arpu'].forEach(s=>$(seg.key+s).addEventListener('input',calc)));
 calc();
});
</script>
</body>
</html>
