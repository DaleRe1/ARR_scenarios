<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ARR Scenarios</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --grad-1: linear-gradient(135deg,#141e30 0%,#243b55 100%);
  --grad-2: linear-gradient(135deg,#1d4350 0%,#a43931 100%);
  --font: 'Inter', sans-serif;
  --accent: #ffd166;
  --card: rgba(255,255,255,.08);
}
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;font-family:var(--font);color:#f2f4f8;scroll-behavior:smooth;overflow-x:hidden}
body{scroll-snap-type:y mandatory}
.slide{width:100vw;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;scroll-snap-align:start;padding:1.5rem;text-align:center;position:relative}
#slide-1{background:var(--grad-1)}
#slide-2{background:var(--grad-2)}
h1{font-size:2.6rem;font-weight:700;margin-bottom:.6rem}
h2{font-size:2rem;font-weight:700;margin-bottom:.6rem}
button{cursor:pointer;background:var(--accent);border:none;border-radius:8px;padding:.65rem 1.3rem;margin-top:1.3rem;font-weight:600;color:#141e30;font-size:1rem}
/* table */
 table{border-collapse:collapse;font-size:.95rem;width:95%;max-width:1040px}
 th,td{padding:.55rem 1rem;white-space:nowrap}
 th{opacity:.85;font-weight:600}
 tr:nth-child(even){background:rgba(255,255,255,.04)}
 .pos{color:#06d6a0;font-weight:600}
 .neg{color:#ff6b6b;font-weight:600}
 .na{color:#9ca3af;font-style:italic}
 .note{position:absolute;bottom:1.2rem;right:1.6rem;background:var(--card);padding:.8rem 1rem;border-radius:8px;font-size:.8rem;backdrop-filter:blur(6px);max-width:280px;text-align:left}
 .note strong{display:block;margin-bottom:.3rem}
 .note ul{margin-left:1rem}
 .note li{list-style:square;margin:.2rem 0}
 /* Slide2 */
 .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem;margin:1.8rem auto;width:100%;max-width:1100px}
 .control{background:var(--card);padding:1rem 1.3rem;border-radius:12px;backdrop-filter:blur(6px)}
 label{display:block;font-size:.85rem;margin-top:.6rem}
 .value{display:block;font-weight:600;margin-top:.25rem}
 input[type=range]{width:100%}
 #metrics{background:var(--card);padding:2rem 3rem;border-radius:14px;backdrop-filter:blur(8px);max-width:840px;font-size:1.05rem}
 #metrics hr{border:none;border-top:1px solid rgba(255,255,255,.25);margin:1rem 0}
</style>
</head>
<body>
<!-- ============ CONFIG ============ -->
<script>
const PERIOD = { cur:'Jul-25', prev:'Jun-25', ytd:'Dec-24' };
const SUMMARY=[
  {name:'E‑Commerce / SMB',cl:{cur:6112,prev:6008,ytd:5615},ar:{cur:10.5,prev:10.3,ytd:9.49}},
  {name:'Stripe BR',       cl:{cur:37,  prev:33,  ytd:null}, ar:{cur:0.1, prev:0.1,ytd:null}},
  {name:'Enterprise',      cl:{cur:66,  prev:64,  ytd:64},   ar:{cur:3.7, prev:3.6,ytd:3.60}}
];
const SENS=[
  {key:'e',name:'E‑Commerce SMB',baseClients:6112,baseARPU:143, addMax:5000, arpuMin:130, arpuMax:260, churnDefault:0},
  {key:'n',name:'Enterprise',    baseClients:66,  baseARPU:4650,addMax:150,  arpuMin:2000,arpuMax:9000,churnDefault:0},
  {key:'b',name:'Stripe BR',     baseClients:37,  baseARPU:180, addMax:15000,arpuMin:100, arpuMax:500, churnDefault:0}
];
</script>
<!-- ============ SLIDE 1 ============ -->
<section class="slide" id="slide-1">
  <h1>ARR Focus</h1>
  <p style="opacity:.85;max-width:820px">Segment Allocation – Client & ARR Growth (MoM & YTD)</p>
  <table id="tbl"></table>
  <div class="note">
    <strong>Scope – Billed ARR only</strong>
    <ul>
      <li>Stripe BR clients registered but not yet invoiced are excluded</li>
      <li>Enterprise contracts signed but not yet activated are excluded</li>
    </ul>
  </div>
  <button onclick="document.getElementById('slide-2').scrollIntoView()">Next → Sensitivity</button>
</section>
<!-- ============ SLIDE 2 ============ -->
<section class="slide" id="slide-2">
  <h2>MRR / ARR Sensitivity – by Segment</h2>
  <p style="opacity:.85;max-width:880px">Adjust Net Client Adds, Churn %, and ARPU. Metrics update live.</p>
  <div class="grid" id="ctrlGrid"></div>
  <div id="metrics"><h3>Sensitivity Output</h3><div id="outBody"></div></div>
</section>
<!-- ============ SCRIPT ============ -->
<script>
/***** helpers *****/
const $=id=>document.getElementById(id);
const fmt=n=>n.toLocaleString('en-GB');
const euro=v=>'€'+fmt(v);
/***** Slide 1 builder *****/
function pct(a,b){return (b?((a-b)/b*100):null);}
function pctCell(a,b){const p=pct(a,b);if(p==null)return '<span class="na">—</span>';const cls=p>=0?'pos':'neg';const s=p>=0?'+':'';return `<span class="${cls}">${s}${p.toFixed(0)}%</span>`;}
function cell(v,dec=0){return v==null?'<span class="na">—</span>':dec?v.toFixed(dec):fmt(v);} 
function buildTable(){
 const rows=SUMMARY.map(s=>`<tr><td>${s.name}</td>
 <td>${cell(s.cl.cur)}</td><td>${cell(s.cl.prev)}</td><td>${pctCell(s.cl.cur,s.cl.prev)}</td><td>${pctCell(s.cl.cur,s.cl.ytd)}</td>
 <td>${cell(s.ar.cur,1)}</td><td>${cell(s.ar.prev,1)}</td><td>${pctCell(s.ar.cur,s.ar.prev)}</td><td>${pctCell(s.ar.cur,s.ar.ytd)}</td></tr>`).join('');
 const totals=SUMMARY.reduce((t,s)=>{
  if(s.cl.cur!=null)t.clCur+=s.cl.cur;
  if(s.cl.prev!=null)t.clPrev+=s.cl.prev;
  if(s.cl.ytd!=null)t.clYTD+=s.cl.ytd;
  if(s.ar.cur!=null)t.arCur+=s.ar.cur;
  if(s.ar.prev!=null)t.arPrev+=s.ar.prev;
  if(s.ar.ytd!=null)t.arYTD+=s.ar.ytd;return t;},{clCur:0,clPrev:0,clYTD:0,arCur:0,arPrev:0,arYTD:0});
 const totalRow=`<tr style="font-weight:600;border-top:1px solid rgba(255,255,255,.25)"><td>Total</td>
 <td>${fmt(totals.clCur)}</td><td>${fmt(totals.clPrev)}</td><td>${pctCell(totals.clCur,totals.clPrev)}</td><td>${pctCell(totals.clCur,totals.clYTD)}</td>
 <td>${totals.arCur.toFixed(1)}</td><td>${totals.arPrev.toFixed(1)}</td><td>${pctCell(totals.arCur,totals.arPrev)}</td><td>${pctCell(totals.arCur,totals.arYTD)}</td></tr>`;
 const head=`<thead><tr><th rowspan="2">Segment</th><th colspan="4">Clients</th><th colspan="4">ARR (€ m)</th></tr>
 <tr><th>${PERIOD.cur}</th><th>${PERIOD.prev}</th><th>MoM %</th><th>YTD<br>vs ${PERIOD.ytd}</th>
     <th>${PERIOD.cur}</th><th>${PERIOD.prev}</th><th>MoM %</th><th>YTD<br>vs ${PERIOD.ytd}</th></tr></thead>`;
 $('tbl').innerHTML=head+'<tbody>'+rows+totalRow+'</tbody>';
}
/***** Slide 2 builder *****/
function buildControls(){
 const g=$('ctrlGrid');
 g.innerHTML=SENS.map(seg=>`<div class="control" id="c-${seg.key}">
  <h3>${seg.name}</h3>
  <label>Net Client Adds (0 – ${fmt(seg.addMax)})</label>
  <input type="range" id="${seg.key}Adds" min="0" max="${seg.addMax}" step="${seg.addMax>500?100:1}" value="0">
  <span class="value" id="${seg.key}AddsVal">0</span>
  <label>Churn % (0 – 10)</label>
  <input type="range" id="${seg.key}Churn" min="0" max="10" step="0.1" value="${seg.churnDefault}">
  <span class="value" id="${seg.key}ChurnVal">${seg.churnDefault.toFixed(1)}%</span>
  <label>ARPU (€${seg.arpuMin} – €${seg.arpuMax})</label>
  <input type="range" id="${seg.key}Arpu" min="${seg.arpuMin}" max="${seg.arpuMax}" step="${seg.arpuMin<200?1:100}" value="${seg.baseARPU}">
  <span class="value" id="${seg.key}ArpuVal">€${fmt(seg.baseARPU)}</span>
 </div>`).join('');
}
function calc(){
 let totMRR=0,totARR=0,html='';
 SENS.forEach(seg=>{
  const adds=+$(seg.key+'Adds').value;
  const churn=+$(seg.key+'Churn').value/100;
  const arpu=+$(seg.key+'Arpu').value;
  const clients=Math.round((seg.baseClients+adds)*(1-churn));
  const mrr=clients*arpu;
  const arr=mrr*12;
  totMRR+=mrr;totARR+=arr;
  // update value readouts
  $(seg.key+'AddsVal').textContent=fmt(adds);
  $(seg.key+'ChurnVal').textContent=(churn*100).toFixed(1)+'%';
  $(seg.key+'ArpuVal').textContent=euro(arpu);
  html+=`<p><strong>${seg.name} Clients:</strong> ${fmt(clients)} | <strong>MRR:</strong> ${euro(mrr)} | <strong>ARR:</strong> ${euro(arr)}</p>`;
 });
 html+='<hr><p><strong>Total MRR:</strong> '+euro(totMRR)+' | <strong>Total ARR:</strong> '+euro(totARR)+'</p>';
 $('outBody').innerHTML=html;
}
/***** init *****/
window.addEventListener('DOMContentLoaded',()=>{
 buildTable();
 buildControls();
 // bind events
 SENS.forEach(seg=>['Adds','Churn','Arpu'].forEach(s=>$(seg.key+s).addEventListener('input',calc)));
 calc();
});
</script>
</body>
</html>
